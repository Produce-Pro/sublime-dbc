. SYNTAX TEST "Packages/dbc/dbc.sublime-syntax"

TEST$._ROUTINE ROUTINE VAR,VAR@,~LABEL:
. <- entity.name.function.dbc
.               ^ entity.name.function.dbc storage.type.dbc
.                      ^ variable.parameter.dbc
.                          ^ variable.parameter.dbc
.                                ^ variable.parameter.dbc
. commment
. <- comment.line.dbc punctuation.definition.comment.dbc
     VAR2,~LABEL2
.    ^ variable.parameter.dbc
.        ^ punctuation.separator.dbc
.          ^ variable.parameter.dbc

VAR.MAX$ EQU 2
. <- entity.name.constant
.         ^ storage.modifier.dbc
.            ^ constant.numeric.dbc

VAR_ CHAR 1[34,VAR.MAX$]
. <- entity.name.type.dbc
.      ^ storage.type.dbc
.         ^ constant.numeric.dbc
.          ^ punctuation.section.brackets.begin.dbc
.           ^ constant.numeric.dbc
.               ^ variable.other.dbc
.                      ^ punctuation.section.brackets.end.dbc

VAR@ CHAR @
. <- entity.name.type.dbc
.      ^ storage.type.dbc
.         ^ storage.modifier.dbc

LABEL LABEL @
. <- entity.name.function.dbc
.      ^ storage.type.dbc
.           ^ storage.modifier.dbc

FORMATTED_CHAR CHAR 30  ..
UPDATE_CHAR EXTERNAL

SOH$LST        LIST
SOHSONO        CHAR 8        SONO          1-    8 S/O no
SOHCUST        CHAR 6        CUST          9-   14 Customer
SOHSHIP        CHAR 6        SHIP         15-   20 Ship to
SOHSLMN        CHAR 6        SLMN         21-   26 Salesperson
SOHSTAT        CHAR 1                     27-   27 Status (O/S/T/V)
SOHCASH        CHAR 1        YN           28-   28 Cash?
SOHOPFG        CHAR 1        YN           29-   29 Sales order contains open priced lines?
SOHCRCD        CHAR 1        CRCD         30-   30 Credit hold code
SOHCSPO        CHAR 25       CSPO25       31-   55 Customer P.O. number
SOHSVIA        CHAR 10       SVIA         56-   65 Ship via
SOHBTCH        CHAR 6        BTCH         66-   71 A/R batch
SOHARCP        CHAR 4        ARCOMP       72-   75 A/R company
SOHTRCD        CHAR 2        TRCD         76-   77 Terms code
SOHCMTX        CHAR 4        TXCD         78-   81 Customer tax code
SOHIVCD        CHAR 1        IVCD         82-   82 Invoice code
SOHDLDT        CHAR 8        DATE         83-   90 Expected delivery date
SOHPKDT        CHAR 8        DATE         91-   98 Pick date
SOHPKTM        CHAR 6        TIME         99-  104 Pick time
SOHSHDT        CHAR 8        DATE        105-  112 Ship date
               LISTEND

     CALL SOMETHING
     MOVE 1 TO Y
     PACK Z WITH 2

     CLEAR SIZE,SIZE2,TYPE.FORM,TYPE
     FILL " " IN TYPE
     LOOP
          GETPARM KEYWORD, VAR
          UNTIL OVER
          SWITCH KEYWORD
               CASE "ARRAY"
                    MOVEADR VAR TO VAR@
               CASE "TYPE"
                    MOVEADR VAR TO TYPE@
               CASE "SIZE"
                    MOVEADR VAR TO SIZE@
               CASE "SIZE2"
                    MOVEADR VAR TO SIZE2@
          ENDSWITCH
     REPEAT

     FORMATVERB IN="TEST",OUT=FORMATTED_CHAR

     CALL UPDATE_CHAR WITH "TEST",FORMATTED_CHAR

     TESTADR SIZE@
     IF NOT OVER
          MOVE SIZE TO SIZE@
     ENDIF
     RETURN

     ENDROUTINE
.     ^ storage.type.dbc

     CALL TEST
